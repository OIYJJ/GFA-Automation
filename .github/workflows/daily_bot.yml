name: GFA Marketing Bot (Lee's PC)

on:
  workflow_dispatch:

jobs:
  run-local-marketing-bot:
    runs-on: self-hosted
    
    steps:
      - name: 1. ìžë™í™” ì‹œìž‘ & í•œê¸€ ì„¤ì •
        shell: cmd
        run: |
          chcp 65001
          echo "ðŸš€ [Start] GFA ë§ˆì¼€íŒ… ë´‡ì„ ê°€ë™í•©ë‹ˆë‹¤..."

      - name: 2. [ì´ˆê¸°í™”] ê¸°ì¡´ í¬ë¡¬ ë° ìž„ì‹œí´ë” ì‚­ì œ
        shell: cmd
        run: |
          echo "ðŸ§¹ ì²­ì†Œ ì‹œìž‘..."
          taskkill /F /IM chrome.exe /T 2>nul
          if exist "C:\chrometemp" rmdir /s /q "C:\chrometemp"
          ping 127.0.0.1 -n 3 > nul

      - name: 3. [í†µí•©] í¬ë¡¬ ì‹¤í–‰ ë° ë°ì´í„° ìˆ˜ì§‘
        shell: cmd
        run: |
          echo "ðŸŒ í¬ë¡¬ ë¸Œë¼ìš°ì €ë¥¼ ì—½ë‹ˆë‹¤ (ì•ˆì „ ì˜µì…˜ ì ìš©)..."
          start "" "C:\Program Files\Google\Chrome\Application\chrome.exe" --remote-debugging-port=9222 --user-data-dir="C:\chrometemp" --no-sandbox --disable-gpu --disable-dev-shm-usage
          
          echo "â³ í¬ë¡¬ ì•ˆì •í™”ë¥¼ ìœ„í•´ 10ì´ˆ ëŒ€ê¸°..."
          ping 127.0.0.1 -n 11 > nul
          
          echo "ðŸ” íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰..."
          set PYTHONIOENCODING=utf-8
          cd /d "C:\Users\82108\Desktop\ì—…ë¬´ìžë™í™”"
          python gfa_bot_final.py

      - name: 4. êµ¬ê¸€ ì‹œíŠ¸ ì—…ë¡œë“œ
        shell: cmd
        run: |
          echo "â˜ï¸ êµ¬ê¸€ ì‹œíŠ¸ ì—…ë¡œë“œ ì‹¤í–‰..."
          set PYTHONIOENCODING=utf-8
          cd /d "C:\Users\82108\Desktop\ì—…ë¬´ìžë™í™”"
          python gfa_to_sheet.py

      - name: 5. ìž‘ì—… ì™„ë£Œ
        shell: cmd
        run: |
          echo "âœ… ëª¨ë“  ìž‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
          echo "60ì´ˆ ë’¤ PCê°€ ì¢…ë£Œë©ë‹ˆë‹¤. (ì·¨ì†Œí•˜ë ¤ë©´ Win+R -> shutdown -a)"
          shutdown -s -f -t 60
