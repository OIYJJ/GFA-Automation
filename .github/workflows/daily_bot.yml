name: GFA Daily Automation

on:
  schedule:
    - cron: '30 20 * * *' # ë§¤ì¼ ì•„ì¹¨ 05:30 ì‹¤í–‰
  workflow_dispatch:

jobs:
  run-bot:
    runs-on: [self-hosted, windows]
    timeout-minutes: 15

    steps:
      - name: 1. ì´ì „ ì‘ì—… ì°Œêº¼ê¸° ì™„ë²½ ì²­ì†Œ
        shell: cmd
        run: |
          chcp 65001
          echo ğŸ§¹ ë‚¨ì•„ìˆëŠ” í¬ë¡¬ í”„ë¡œì„¸ìŠ¤ì™€ ì ê¸ˆ íŒŒì¼ì„ ì •ë¦¬í•©ë‹ˆë‹¤...
          taskkill /F /IM chrome.exe /T >nul 2>&1 || exit 0
          taskkill /F /IM chromedriver.exe /T >nul 2>&1 || exit 0
          if exist "C:\chrometemp\SingletonLock" del /f /q "C:\chrometemp\SingletonLock" >nul 2>&1 || exit 0
          if exist "C:\chrometemp\SingletonCookie" del /f /q "C:\chrometemp\SingletonCookie" >nul 2>&1 || exit 0
          if exist "C:\chrometemp\SingletonSocket" del /f /q "C:\chrometemp\SingletonSocket" >nul 2>&1 || exit 0

      - name: 2. GFA ë°ì´í„° ìˆ˜ì§‘ (íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ 1)
        shell: cmd
        working-directory: "C:\\Users\\82108\\Desktop\\ì—…ë¬´ìë™í™”"
        run: |
          chcp 65001
          set PYTHONIOENCODING=utf-8
          python gfa_bot_final.py

      - name: 3. êµ¬ê¸€ ì‹œíŠ¸ ì—…ë¡œë“œ (íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ 2)
        shell: cmd
        working-directory: "C:\\Users\\82108\\Desktop\\ì—…ë¬´ìë™í™”"
        run: |
          chcp 65001
          set PYTHONIOENCODING=utf-8
          python gfa_to_sheet.py
